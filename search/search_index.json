{"config":{"indexing":"full","lang":["en"],"min_search_length":3,"prebuild_index":false,"separator":"[\\s\\-]+"},"docs":[{"location":"","text":"Welcome to Tetrate Tech Talks, a weekly livestream where we feature a conversation with a guest to discuss technology, technical demonstrations and more. Tetrate is the enterprise service mesh company. Much of our focus is on service meshes, Istio , Envoy , Kubernetes and more. But we won't shy away from topics that are further afield. There's plenty to talk about! Our first episode took place on April 1 2022. Visit our YouTube playlist . Upcoming Episodes \u00b6 All episodes are scheduled for 9:00 AM Pacific time. Episode 2 - April 8 2022: Upgrading Istio Episode 3 - April 15 2022. Topic to be announced Episode 4 - April 22 2022: Exploring Kiali with Lucas Ponce Bye week - April 29 2022 is IstioCon . Episode 5 - May 6 2022: Web Assembly with Brian Sletten Stay tuned as we line up additional guests and topics! Past Episodes: \u00b6 Episode 1 - April 1 2022: Onboarding VMs , Guest: Bart van Bos","title":"Home"},{"location":"#upcoming-episodes","text":"All episodes are scheduled for 9:00 AM Pacific time. Episode 2 - April 8 2022: Upgrading Istio Episode 3 - April 15 2022. Topic to be announced Episode 4 - April 22 2022: Exploring Kiali with Lucas Ponce Bye week - April 29 2022 is IstioCon . Episode 5 - May 6 2022: Web Assembly with Brian Sletten Stay tuned as we line up additional guests and topics!","title":"Upcoming Episodes"},{"location":"#past-episodes","text":"Episode 1 - April 1 2022: Onboarding VMs , Guest: Bart van Bos","title":"Past Episodes:"},{"location":"episode1/","text":"Episode 1 \u00b6 Recorded episode Your Host: Eitan Suez \u00b6 Eitan will be hosting this episode from Austin, Texas. Topic: How to connect VM workloads to Istio Mesh \u00b6 There's much to explore about service meshes. Istio deployments run on Kubernetes, but did you know that you can expand the mesh to include applications running on VMs? We begin the episode with a demonstration of how to add a VM to your Istio mesh, based on the terrific Istio documentation . Eitan will be running the demonstration. If you'd like to follow along, the instructions are here . Guest: Bart van Bos \u00b6 Bart is a Tetrand living and working in Belgium. Bart has experience working with customers and integrating service meshes in the enterprise. Bring your questions! When \u00b6 Friday 2022.04.01 @ 9:00 AM Pacific time","title":"Description"},{"location":"episode1/#episode-1","text":"Recorded episode","title":"Episode 1"},{"location":"episode1/#your-host-eitan-suez","text":"Eitan will be hosting this episode from Austin, Texas.","title":"Your Host: Eitan Suez"},{"location":"episode1/#topic-how-to-connect-vm-workloads-to-istio-mesh","text":"There's much to explore about service meshes. Istio deployments run on Kubernetes, but did you know that you can expand the mesh to include applications running on VMs? We begin the episode with a demonstration of how to add a VM to your Istio mesh, based on the terrific Istio documentation . Eitan will be running the demonstration. If you'd like to follow along, the instructions are here .","title":"Topic:  How to connect VM workloads to Istio Mesh"},{"location":"episode1/#guest-bart-van-bos","text":"Bart is a Tetrand living and working in Belgium. Bart has experience working with customers and integrating service meshes in the enterprise. Bring your questions!","title":"Guest: Bart van Bos"},{"location":"episode1/#when","text":"Friday 2022.04.01 @ 9:00 AM Pacific time","title":"When"},{"location":"episode1/presentation/","text":"About Tetrate Tech Talks \u00b6 A new series of broadcasts that runs every Friday at 9:00 AM Pacific streamed to YouTube and to LinkedIn Live. Objectives: learning and sharing knowledge getting to know the diverse members of the service mesh community have fun! Episodes present a technical topic and feature a guest. Meet our CEO, Varun Talwar \u00b6 Varun, meet the Service Mesh community! q: In your own words.. what this new broadcast series is all about? I'm your host, Eitan Suez \u00b6 I work at Tetrate, and I like to talk tech. A little bit about myself and my background.. I've spent a lot of time in the last few years doing a lot of technical explaining: technical education, training, in-person, online, conference training, and more. My background has a long tail so to speak, I started out as an electrical engineer turned software engineer. An abbreviated history.. was gung ho about the web in the years when netscape announced its browser. Did a lot of Java and Javascript, startups in the late 90's and early 2000's, user group community stuff, conference speaking, Groovy, Spring, consulting, to education. Moved from dev to ops with cloud foundry and bosh, then to Kubernetes and now to all things service mesh. You'll have plenty of opportunity to get to know me in this and upcoming episodes! Tetrate Tech Talks web page \u00b6 https://tetratelabs.github.io/tetrate-tech-talks/ \u00b6 Free Workshops! \u00b6 Istio 0 to 60 (May 4) WASM (April 20) We run these workshops periodically. But the lab materials are free and available for you to work through (and contribute to) at any time. Upcoming Industry Events \u00b6 IstioCon 2022 , April 25-29 I hope to be conducting a workshop.. Istio 0 to 60. Join me! ServiceMeshCon & KubeCon EU , May 16 + 17-20 Tetrate will be running its own one-day event with keynotes, talks, and announcements. Stay tuned for more information on that. Come join us in Valencia, Spain! Austin Roadshow - April 21 Stay tuned for more information on that event as well. Join the conversation.. \u00b6 ..on our Slack channel : https://tetrate-community.slack.com/ \u00b6 Finally.. the episode \u00b6 What are we going to learn? How to connect VM workloads to Istio Mesh Our Guest: Bart van Bos Let's get started .. Did I mention.. join the conversation? \u00b6 https://tetrate-community.slack.com/","title":"Presentation"},{"location":"episode1/presentation/#about-tetrate-tech-talks","text":"A new series of broadcasts that runs every Friday at 9:00 AM Pacific streamed to YouTube and to LinkedIn Live. Objectives: learning and sharing knowledge getting to know the diverse members of the service mesh community have fun! Episodes present a technical topic and feature a guest.","title":"About Tetrate Tech Talks"},{"location":"episode1/presentation/#meet-our-ceo-varun-talwar","text":"Varun, meet the Service Mesh community! q: In your own words.. what this new broadcast series is all about?","title":"Meet our CEO, Varun Talwar"},{"location":"episode1/presentation/#im-your-host-eitan-suez","text":"I work at Tetrate, and I like to talk tech. A little bit about myself and my background.. I've spent a lot of time in the last few years doing a lot of technical explaining: technical education, training, in-person, online, conference training, and more. My background has a long tail so to speak, I started out as an electrical engineer turned software engineer. An abbreviated history.. was gung ho about the web in the years when netscape announced its browser. Did a lot of Java and Javascript, startups in the late 90's and early 2000's, user group community stuff, conference speaking, Groovy, Spring, consulting, to education. Moved from dev to ops with cloud foundry and bosh, then to Kubernetes and now to all things service mesh. You'll have plenty of opportunity to get to know me in this and upcoming episodes!","title":"I'm your host, Eitan Suez"},{"location":"episode1/presentation/#tetrate-tech-talks-web-page","text":"","title":"Tetrate Tech Talks web page"},{"location":"episode1/presentation/#httpstetratelabsgithubiotetrate-tech-talks","text":"","title":"https://tetratelabs.github.io/tetrate-tech-talks/"},{"location":"episode1/presentation/#free-workshops","text":"Istio 0 to 60 (May 4) WASM (April 20) We run these workshops periodically. But the lab materials are free and available for you to work through (and contribute to) at any time.","title":"Free Workshops!"},{"location":"episode1/presentation/#upcoming-industry-events","text":"IstioCon 2022 , April 25-29 I hope to be conducting a workshop.. Istio 0 to 60. Join me! ServiceMeshCon & KubeCon EU , May 16 + 17-20 Tetrate will be running its own one-day event with keynotes, talks, and announcements. Stay tuned for more information on that. Come join us in Valencia, Spain! Austin Roadshow - April 21 Stay tuned for more information on that event as well.","title":"Upcoming Industry Events"},{"location":"episode1/presentation/#join-the-conversation","text":"..on our Slack channel :","title":"Join the conversation.."},{"location":"episode1/presentation/#httpstetrate-communityslackcom","text":"","title":"https://tetrate-community.slack.com/"},{"location":"episode1/presentation/#finally-the-episode","text":"What are we going to learn? How to connect VM workloads to Istio Mesh Our Guest: Bart van Bos Let's get started ..","title":"Finally.. the episode"},{"location":"episode1/presentation/#did-i-mention-join-the-conversation","text":"https://tetrate-community.slack.com/","title":"Did I mention.. join the conversation?"},{"location":"episode1/demo/","text":"Connect VM Workloads to Istio mesh \u00b6 This document is a recipe illustrating Istio mesh expansion using a single network and a single cluster. We install Istio and deploy all BookInfo services to the mesh, with the exception of the ratings service, which will run separately on a VM. The idea is to make this work, and thereby to demonstrate that Istio supports a mesh where some services run in-cluster and some outside it. The artifacts referenced in these instructions can be obtained from the GitHub repository for this site. Prerequisites \u00b6 A GCP or other cloud account Create K8s Cluster \u00b6 ./scripts/make-gke-cluster Wait until cluster is ready. Create the VM \u00b6 gcloud compute instances create my-mesh-vm --tags = mesh-vm \\ --machine-type = n1-standard-2 \\ --network = default --subnet = default \\ --image-project = ubuntu-os-cloud \\ --image = ubuntu-2110-impish-v20220309 Install ratings app on the VM \u00b6 Wait for the machine to be ready. Copy over the ratings app gcloud compute scp --recurse bookinfo/ratings ubuntu@my-mesh-vm:ratings ssh onto the VM gcloud compute ssh ubuntu@my-mesh-vm Install nodejs, the ratings app and start it, test it. sudo apt-get update sudo apt-get install nodejs npm Install dependencies cd ratings/ npm install Run the app: node ratings.js 9080 & Test the app. Retrieve a rating. curl http://localhost:9080/ratings/123 Allow POD-to-VM traffic on port 9080 \u00b6 CLUSTER_POD_CIDR = $( gcloud container clusters describe my-istio-cluster --format = json | jq -r '.clusterIpv4Cidr' ) gcloud compute firewall-rules create \"cluster-pods-to-vm\" \\ --source-ranges = $CLUSTER_POD_CIDR \\ --target-tags = mesh-vm \\ --action = allow \\ --rules = tcp:9080 Install Istio \u00b6 istioctl install \\ --set values.pilot.env.PILOT_ENABLE_WORKLOAD_ENTRY_AUTOREGISTRATION = true \\ --set values.pilot.env.PILOT_ENABLE_WORKLOAD_ENTRY_HEALTHCHECKS = true Deploy BookInfo (sans ratings) \u00b6 Turn on sidecar-injection. k label ns default istio-injection = enabled Deploy the reviews service. k apply -f bookinfo/bookinfo-reviews.yaml Important: the reviews service uses an environment variable named SERVICES_DOMAIN that we use to adjust the ratings app target url to reflect the fact that it resides in a different namespace. Deploy the remaining services. k apply -f bookinfo/bookinfo-rest.yaml Install east-west gateway and expose Istiod \u00b6 Control plane traffic between the VM and istiod goes through this gateway (see the Istio documentation ). Install the gateway ./scripts/gen-eastwest-gateway.sh --single-cluster | istioctl install -y -f - Expose istiod k apply -n istio-system -f ./artifacts/expose-istiod.yaml Create the ratings namespace and service account \u00b6 The ratings service running on the VM will map to the ratings namespace in kubernetes. k create namespace ratings k create serviceaccount bookinfo-ratings -n ratings Create the WorkloadGroup \u00b6 A WorkloadGroup is a template for WorkloadEntity objects, see the Istio reference . istioctl x workload group create \\ --name \"ratings\" \\ --namespace \"ratings\" \\ --labels app = \"ratings\" \\ --serviceAccount \"bookinfo-ratings\" > workloadgroup.yaml Apply the workloadgroup: k apply -f workloadgroup.yaml -n ratings Generate VM artifacts \u00b6 istioctl x workload entry configure -f workloadgroup.yaml -o vm_files --autoregister Note: check that vm_files/hosts is not blank. If it is, it means you ran the command too soon. Re-run it. VM configuration recipe \u00b6 Copy the generated artifacts to the VM. gcloud compute scp vm_files/* ubuntu@my-mesh-vm: Ssh onto the VM gcloud compute ssh ubuntu@my-mesh-vm And, on the VM, run the following commands (taken from here ). sudo mkdir -p /etc/certs sudo cp ~/root-cert.pem /etc/certs/root-cert.pem sudo mkdir -p /var/run/secrets/tokens sudo cp ~/istio-token /var/run/secrets/tokens/istio-token curl -LO https://storage.googleapis.com/istio-release/releases/1.13.2/deb/istio-sidecar.deb sudo dpkg -i istio-sidecar.deb sudo cp ~/cluster.env /var/lib/istio/envoy/cluster.env sudo cp ~/mesh.yaml /etc/istio/config/mesh sudo sh -c 'cat $(eval echo ~$SUDO_USER)/hosts >> /etc/hosts' sudo mkdir -p /etc/istio/proxy sudo chown -R istio-proxy /etc/certs /var/run/secrets /var/lib/istio /etc/istio/config /etc/istio/proxy Exercise 1 \u00b6 Watch the WorkloadEntry get created as a consequence of the VM registering with the mesh. k get workloadentry -n ratings -w On the VM: sudo systemctl start istio Notice the workload entry show up in the listing. This can take up to a minute. Exercise 2 \u00b6 Although the ratings services does not need to call back into the mesh, we can manually test communication from the VM into the mesh. From the VM, run: curl details.default.svc:9080/details/123 Exercise 3 \u00b6 Test communication from a pod to the ratings service running on the VM. Create a ClusterIP service to front the application: k apply -n ratings -f bookinfo/bookinfo-ratings-service.yaml Create a temporary client pod in the default namespace k run curlpod --image = radial/busyboxplus:curl -it --rm From within the container, run the curl command: curl ratings.ratings:9080/ratings/123 Finally, exit the container. Put it all together \u00b6 Expose BookInfo: k apply -f bookinfo/bookinfo-gateway.yaml Grab your load balancer public IP address: GATEWAY_IP = $( kubectl get svc -n istio-system istio-ingressgateway -ojsonpath = '{.status.loadBalancer.ingress[0].ip}' ) Open a browser and visit the BookInfo product page (at /productpage). Verify that you can see ratings on the page. curl $GATEWAY_IP /productpage References \u00b6 Istio VM Architecture Basic recipe from the Istio docs GCP-specific information on mesh expansion (dated)","title":"Demo"},{"location":"episode1/demo/#connect-vm-workloads-to-istio-mesh","text":"This document is a recipe illustrating Istio mesh expansion using a single network and a single cluster. We install Istio and deploy all BookInfo services to the mesh, with the exception of the ratings service, which will run separately on a VM. The idea is to make this work, and thereby to demonstrate that Istio supports a mesh where some services run in-cluster and some outside it. The artifacts referenced in these instructions can be obtained from the GitHub repository for this site.","title":"Connect VM Workloads to Istio mesh"},{"location":"episode1/demo/#prerequisites","text":"A GCP or other cloud account","title":"Prerequisites"},{"location":"episode1/demo/#create-k8s-cluster","text":"./scripts/make-gke-cluster Wait until cluster is ready.","title":"Create K8s Cluster"},{"location":"episode1/demo/#create-the-vm","text":"gcloud compute instances create my-mesh-vm --tags = mesh-vm \\ --machine-type = n1-standard-2 \\ --network = default --subnet = default \\ --image-project = ubuntu-os-cloud \\ --image = ubuntu-2110-impish-v20220309","title":"Create the VM"},{"location":"episode1/demo/#install-ratings-app-on-the-vm","text":"Wait for the machine to be ready. Copy over the ratings app gcloud compute scp --recurse bookinfo/ratings ubuntu@my-mesh-vm:ratings ssh onto the VM gcloud compute ssh ubuntu@my-mesh-vm Install nodejs, the ratings app and start it, test it. sudo apt-get update sudo apt-get install nodejs npm Install dependencies cd ratings/ npm install Run the app: node ratings.js 9080 & Test the app. Retrieve a rating. curl http://localhost:9080/ratings/123","title":"Install ratings app on the VM"},{"location":"episode1/demo/#allow-pod-to-vm-traffic-on-port-9080","text":"CLUSTER_POD_CIDR = $( gcloud container clusters describe my-istio-cluster --format = json | jq -r '.clusterIpv4Cidr' ) gcloud compute firewall-rules create \"cluster-pods-to-vm\" \\ --source-ranges = $CLUSTER_POD_CIDR \\ --target-tags = mesh-vm \\ --action = allow \\ --rules = tcp:9080","title":"Allow POD-to-VM traffic on port 9080"},{"location":"episode1/demo/#install-istio","text":"istioctl install \\ --set values.pilot.env.PILOT_ENABLE_WORKLOAD_ENTRY_AUTOREGISTRATION = true \\ --set values.pilot.env.PILOT_ENABLE_WORKLOAD_ENTRY_HEALTHCHECKS = true","title":"Install Istio"},{"location":"episode1/demo/#deploy-bookinfo-sans-ratings","text":"Turn on sidecar-injection. k label ns default istio-injection = enabled Deploy the reviews service. k apply -f bookinfo/bookinfo-reviews.yaml Important: the reviews service uses an environment variable named SERVICES_DOMAIN that we use to adjust the ratings app target url to reflect the fact that it resides in a different namespace. Deploy the remaining services. k apply -f bookinfo/bookinfo-rest.yaml","title":"Deploy BookInfo (sans ratings)"},{"location":"episode1/demo/#install-east-west-gateway-and-expose-istiod","text":"Control plane traffic between the VM and istiod goes through this gateway (see the Istio documentation ). Install the gateway ./scripts/gen-eastwest-gateway.sh --single-cluster | istioctl install -y -f - Expose istiod k apply -n istio-system -f ./artifacts/expose-istiod.yaml","title":"Install east-west gateway and expose Istiod"},{"location":"episode1/demo/#create-the-ratings-namespace-and-service-account","text":"The ratings service running on the VM will map to the ratings namespace in kubernetes. k create namespace ratings k create serviceaccount bookinfo-ratings -n ratings","title":"Create the ratings namespace and service account"},{"location":"episode1/demo/#create-the-workloadgroup","text":"A WorkloadGroup is a template for WorkloadEntity objects, see the Istio reference . istioctl x workload group create \\ --name \"ratings\" \\ --namespace \"ratings\" \\ --labels app = \"ratings\" \\ --serviceAccount \"bookinfo-ratings\" > workloadgroup.yaml Apply the workloadgroup: k apply -f workloadgroup.yaml -n ratings","title":"Create the WorkloadGroup"},{"location":"episode1/demo/#generate-vm-artifacts","text":"istioctl x workload entry configure -f workloadgroup.yaml -o vm_files --autoregister Note: check that vm_files/hosts is not blank. If it is, it means you ran the command too soon. Re-run it.","title":"Generate VM artifacts"},{"location":"episode1/demo/#vm-configuration-recipe","text":"Copy the generated artifacts to the VM. gcloud compute scp vm_files/* ubuntu@my-mesh-vm: Ssh onto the VM gcloud compute ssh ubuntu@my-mesh-vm And, on the VM, run the following commands (taken from here ). sudo mkdir -p /etc/certs sudo cp ~/root-cert.pem /etc/certs/root-cert.pem sudo mkdir -p /var/run/secrets/tokens sudo cp ~/istio-token /var/run/secrets/tokens/istio-token curl -LO https://storage.googleapis.com/istio-release/releases/1.13.2/deb/istio-sidecar.deb sudo dpkg -i istio-sidecar.deb sudo cp ~/cluster.env /var/lib/istio/envoy/cluster.env sudo cp ~/mesh.yaml /etc/istio/config/mesh sudo sh -c 'cat $(eval echo ~$SUDO_USER)/hosts >> /etc/hosts' sudo mkdir -p /etc/istio/proxy sudo chown -R istio-proxy /etc/certs /var/run/secrets /var/lib/istio /etc/istio/config /etc/istio/proxy","title":"VM configuration recipe"},{"location":"episode1/demo/#exercise-1","text":"Watch the WorkloadEntry get created as a consequence of the VM registering with the mesh. k get workloadentry -n ratings -w On the VM: sudo systemctl start istio Notice the workload entry show up in the listing. This can take up to a minute.","title":"Exercise 1"},{"location":"episode1/demo/#exercise-2","text":"Although the ratings services does not need to call back into the mesh, we can manually test communication from the VM into the mesh. From the VM, run: curl details.default.svc:9080/details/123","title":"Exercise 2"},{"location":"episode1/demo/#exercise-3","text":"Test communication from a pod to the ratings service running on the VM. Create a ClusterIP service to front the application: k apply -n ratings -f bookinfo/bookinfo-ratings-service.yaml Create a temporary client pod in the default namespace k run curlpod --image = radial/busyboxplus:curl -it --rm From within the container, run the curl command: curl ratings.ratings:9080/ratings/123 Finally, exit the container.","title":"Exercise 3"},{"location":"episode1/demo/#put-it-all-together","text":"Expose BookInfo: k apply -f bookinfo/bookinfo-gateway.yaml Grab your load balancer public IP address: GATEWAY_IP = $( kubectl get svc -n istio-system istio-ingressgateway -ojsonpath = '{.status.loadBalancer.ingress[0].ip}' ) Open a browser and visit the BookInfo product page (at /productpage). Verify that you can see ratings on the page. curl $GATEWAY_IP /productpage","title":"Put it all together"},{"location":"episode1/demo/#references","text":"Istio VM Architecture Basic recipe from the Istio docs GCP-specific information on mesh expansion (dated)","title":"References"},{"location":"episode2/","text":"Episode 2 \u00b6 Your Host: Eitan Suez \u00b6 Eitan will be hosting this episode from Austin, Texas. Topic: Canary Upgrading Istio \u00b6 Eitan will demonstrate the process of canary-upgrading Istio on a Kubernetes cluster, based on the Istio documentation . If you'd like to follow along, the instructions are here . When \u00b6 Friday 2022.04.08 @ 9:00 AM Pacific time Here is the link to the live stream on LinkedIn Live .","title":"Description"},{"location":"episode2/#episode-2","text":"","title":"Episode 2"},{"location":"episode2/#your-host-eitan-suez","text":"Eitan will be hosting this episode from Austin, Texas.","title":"Your Host: Eitan Suez"},{"location":"episode2/#topic-canary-upgrading-istio","text":"Eitan will demonstrate the process of canary-upgrading Istio on a Kubernetes cluster, based on the Istio documentation . If you'd like to follow along, the instructions are here .","title":"Topic:  Canary Upgrading Istio"},{"location":"episode2/#when","text":"Friday 2022.04.08 @ 9:00 AM Pacific time Here is the link to the live stream on LinkedIn Live .","title":"When"},{"location":"episode2/presentation/","text":"About Tetrate Tech Talks \u00b6 A new series of broadcasts that runs every Friday at 9:00 AM Pacific streamed to YouTube and to LinkedIn Live. https://tetratelabs.github.io/tetrate-tech-talks/ \u00b6 Objectives: learning and sharing knowledge getting to know the diverse members of the service mesh community have fun! Episodes present a technical topic and feature a guest. I'm your host, Eitan Suez \u00b6 I work at Tetrate, and I like to talk tech. Previously on Tetrate Tech Talks.. \u00b6 In the last episode we discussed onboarding VMs to a mesh. My colleague Peter Jausovec, tuned me onto a blog entry titled an easier way to add virtual machines to Istio services mesh , which I recommend you check out, to get deeper into that topic. Free Workshops! \u00b6 WASM (April 20) Istio 0 to 60 (May 4) We run these workshops periodically. But the lab materials are free and available for you to work through (and contribute to) at any time. Upcoming Industry Events \u00b6 IstioCon 2022 , April 25-29 I will be conducting a workshop.. Istio 0 to 60. Join me! ServiceMeshCon & KubeCon EU , May 16 + 17-20 Tetrate will be running its own one-day event with keynotes, talks, and announcements. Come join us in Valencia, Spain! Austin Roadshow - April 21 Join the conversation.. \u00b6 ..on our Slack channel : https://tetrate-community.slack.com/ \u00b6 Finally.. the episode \u00b6 What are we going to learn? Upgrading Istio \u00b6 Let's get started ..","title":"Presentation"},{"location":"episode2/presentation/#about-tetrate-tech-talks","text":"A new series of broadcasts that runs every Friday at 9:00 AM Pacific streamed to YouTube and to LinkedIn Live.","title":"About Tetrate Tech Talks"},{"location":"episode2/presentation/#httpstetratelabsgithubiotetrate-tech-talks","text":"Objectives: learning and sharing knowledge getting to know the diverse members of the service mesh community have fun! Episodes present a technical topic and feature a guest.","title":"https://tetratelabs.github.io/tetrate-tech-talks/"},{"location":"episode2/presentation/#im-your-host-eitan-suez","text":"I work at Tetrate, and I like to talk tech.","title":"I'm your host, Eitan Suez"},{"location":"episode2/presentation/#previously-on-tetrate-tech-talks","text":"In the last episode we discussed onboarding VMs to a mesh. My colleague Peter Jausovec, tuned me onto a blog entry titled an easier way to add virtual machines to Istio services mesh , which I recommend you check out, to get deeper into that topic.","title":"Previously on Tetrate Tech Talks.."},{"location":"episode2/presentation/#free-workshops","text":"WASM (April 20) Istio 0 to 60 (May 4) We run these workshops periodically. But the lab materials are free and available for you to work through (and contribute to) at any time.","title":"Free Workshops!"},{"location":"episode2/presentation/#upcoming-industry-events","text":"IstioCon 2022 , April 25-29 I will be conducting a workshop.. Istio 0 to 60. Join me! ServiceMeshCon & KubeCon EU , May 16 + 17-20 Tetrate will be running its own one-day event with keynotes, talks, and announcements. Come join us in Valencia, Spain! Austin Roadshow - April 21","title":"Upcoming Industry Events"},{"location":"episode2/presentation/#join-the-conversation","text":"..on our Slack channel :","title":"Join the conversation.."},{"location":"episode2/presentation/#httpstetrate-communityslackcom","text":"","title":"https://tetrate-community.slack.com/"},{"location":"episode2/presentation/#finally-the-episode","text":"What are we going to learn?","title":"Finally.. the episode"},{"location":"episode2/presentation/#upgrading-istio","text":"Let's get started ..","title":"Upgrading Istio"},{"location":"episode2/demo/","text":"Upgrading Istio \u00b6 This document demonstrates upgrading Istio in a way that allows operators to be in control of the transition of workloads from one version to the next. This document is an adaptation of the document entitled Canary Upgrades from the official Istio documentation. The BookInfo sample application will serve as the workload under test. Warning Feature status of Revision Based Upgrades is alpha In this exercise, we will: Install a Kubernetes cluster Install Istio v1.12.5 Deploy the BookInfo sample application to the default namespace. Next, we: Install Istio v1.13.2, triggering solely the upgrade of the ingress gateway (not the workloads) Demonstrate namespace labeling as the mechanism for controlling the desired version of Istio to use for workloads in that namespace. Teardown previous version of Istio, completing the upgrade. Finally, we will demonstrate an alternative to labeling namespaces directly, by using what Istio calls Revision Tags . Note In the instructions that follow, I use GCP as my infastructure, but feel free to use any Kubernetes you like. Create a K8s Cluster \u00b6 gcloud container clusters create my-istio-cluster \\ --cluster-version latest \\ --machine-type \"n1-standard-2\" \\ --num-nodes \"3\" \\ --network \"default\" Wait until cluster is ready. Client Setup \u00b6 In a workspace directory of your choice, download two Istio releases, 1.12.5 and 1.13.2. Be sure to use the hardware architecture matching your workstation: curl -L https://istio.io/downloadIstio | ISTIO_VERSION = 1 .12.5 TARGET_ARCH = arm64 sh - curl -L https://istio.io/downloadIstio | ISTIO_VERSION = 1 .13.2 TARGET_ARCH = arm64 sh - Setting your PATH \u00b6 I use direnv to easily update my PATH so that istioctl points to version 1.12.5 or version 1.13.2 as a function of the directory that i navigate to. Given a file named .envrc in the folder istio-1.12.5 : #!/bin/sh export PATH = ./bin: $PATH I can run direnv allow , and note that running istioctl version from that directory returns 1.12.5 . Likewise, the same file in the istio-1.13.2 directory allows me to quickly switch to that version. Install Istio \u00b6 Pre-check: istioctl x precheck Install: istioctl install --set revision = 1 -12-5 Check: k get pods -n istio-system -l app = istiod k get svc -n istio-system -l app = istiod k get mutatingwebhookconfigurations Check the ingressgateway Istio version: istioctl proxy-status Label the default namespace \u00b6 k label namespace default istio.io/rev = 1 -12-5 Check: k get ns -Listio.io/rev Deploy BookInfo \u00b6 kubectl apply -f samples/bookinfo/platform/kube/bookinfo.yaml Check: kubectl exec \" $( kubectl get pod -l app = ratings -o jsonpath = '{.items[0].metadata.name}' ) \" -c ratings -- curl -sS productpage:9080/productpage | grep -o \"<title>.*</title>\" Configure ingress: kubectl apply -f samples/bookinfo/networking/bookinfo-gateway.yaml Check: GATEWAY_IP = $( kubectl get svc -n istio-system istio-ingressgateway -ojsonpath = '{.status.loadBalancer.ingress[0].ip}' ) Open a browser and visit the BookInfo product page (at /productpage ). curl $GATEWAY_IP /productpage Verifying that workloads use version 1.12.5 \u00b6 With istioctl proxy-status istioctl proxy-status Checking the server_info endpoint of a sidecar: istioctl dashboard envoy deployment/details-v1.default And check that the ANNOTATIONS revision is 1-12-5 Describe the pod k describe pod details-v1-<tab> Switch directories \u00b6 cd ../istio-1.13.2 Make sure your PATH now points to version 1.13.2 of the istioctl CLI: istioctl version Install Istio version 1.13.2 \u00b6 Pre-check: istioctl x precheck Install: istioctl install --set revision = 1 -13-2 Both 1-13-2 and 1-12-5 istiod's are installed ingressgateway has been upgraded to 1.13.2 Pods still use 1-12-5 Check: k get pods -n istio-system -l app = istiod And: istioctl proxy-status Update namespace label \u00b6 kubectl label namespace default istio.io/rev = 1 -13-2 --overwrite Check: k get ns -Listio.io/rev Restart the deployments in the default namespace \u00b6 kubectl rollout restart deployment -n default istioctl proxy-status Teardown the old version \u00b6 istioctl x uninstall --revision 1 -12-5 Verify that the bookinfo application is still alive and well. Using Revision Tags \u00b6 Instead of specifying the actual revision we want, we use a semantic name, like prod : k label ns default istio.io/rev = prod --overwrite And then associate prod to a revision: istioctl tag set prod --revision 1 -13-2 Check: istioctl tag list To change what prod means, we associate a different revision to it: istioctl tag set prod --revision 1 -12-3 --overwrite References \u00b6 Canary upgrades Revision tags Blog entry","title":"Demo"},{"location":"episode2/demo/#upgrading-istio","text":"This document demonstrates upgrading Istio in a way that allows operators to be in control of the transition of workloads from one version to the next. This document is an adaptation of the document entitled Canary Upgrades from the official Istio documentation. The BookInfo sample application will serve as the workload under test. Warning Feature status of Revision Based Upgrades is alpha In this exercise, we will: Install a Kubernetes cluster Install Istio v1.12.5 Deploy the BookInfo sample application to the default namespace. Next, we: Install Istio v1.13.2, triggering solely the upgrade of the ingress gateway (not the workloads) Demonstrate namespace labeling as the mechanism for controlling the desired version of Istio to use for workloads in that namespace. Teardown previous version of Istio, completing the upgrade. Finally, we will demonstrate an alternative to labeling namespaces directly, by using what Istio calls Revision Tags . Note In the instructions that follow, I use GCP as my infastructure, but feel free to use any Kubernetes you like.","title":"Upgrading Istio"},{"location":"episode2/demo/#create-a-k8s-cluster","text":"gcloud container clusters create my-istio-cluster \\ --cluster-version latest \\ --machine-type \"n1-standard-2\" \\ --num-nodes \"3\" \\ --network \"default\" Wait until cluster is ready.","title":"Create a K8s Cluster"},{"location":"episode2/demo/#client-setup","text":"In a workspace directory of your choice, download two Istio releases, 1.12.5 and 1.13.2. Be sure to use the hardware architecture matching your workstation: curl -L https://istio.io/downloadIstio | ISTIO_VERSION = 1 .12.5 TARGET_ARCH = arm64 sh - curl -L https://istio.io/downloadIstio | ISTIO_VERSION = 1 .13.2 TARGET_ARCH = arm64 sh -","title":"Client Setup"},{"location":"episode2/demo/#setting-your-path","text":"I use direnv to easily update my PATH so that istioctl points to version 1.12.5 or version 1.13.2 as a function of the directory that i navigate to. Given a file named .envrc in the folder istio-1.12.5 : #!/bin/sh export PATH = ./bin: $PATH I can run direnv allow , and note that running istioctl version from that directory returns 1.12.5 . Likewise, the same file in the istio-1.13.2 directory allows me to quickly switch to that version.","title":"Setting your PATH"},{"location":"episode2/demo/#install-istio","text":"Pre-check: istioctl x precheck Install: istioctl install --set revision = 1 -12-5 Check: k get pods -n istio-system -l app = istiod k get svc -n istio-system -l app = istiod k get mutatingwebhookconfigurations Check the ingressgateway Istio version: istioctl proxy-status","title":"Install Istio"},{"location":"episode2/demo/#label-the-default-namespace","text":"k label namespace default istio.io/rev = 1 -12-5 Check: k get ns -Listio.io/rev","title":"Label the default namespace"},{"location":"episode2/demo/#deploy-bookinfo","text":"kubectl apply -f samples/bookinfo/platform/kube/bookinfo.yaml Check: kubectl exec \" $( kubectl get pod -l app = ratings -o jsonpath = '{.items[0].metadata.name}' ) \" -c ratings -- curl -sS productpage:9080/productpage | grep -o \"<title>.*</title>\" Configure ingress: kubectl apply -f samples/bookinfo/networking/bookinfo-gateway.yaml Check: GATEWAY_IP = $( kubectl get svc -n istio-system istio-ingressgateway -ojsonpath = '{.status.loadBalancer.ingress[0].ip}' ) Open a browser and visit the BookInfo product page (at /productpage ). curl $GATEWAY_IP /productpage","title":"Deploy BookInfo"},{"location":"episode2/demo/#verifying-that-workloads-use-version-1125","text":"With istioctl proxy-status istioctl proxy-status Checking the server_info endpoint of a sidecar: istioctl dashboard envoy deployment/details-v1.default And check that the ANNOTATIONS revision is 1-12-5 Describe the pod k describe pod details-v1-<tab>","title":"Verifying that workloads use version 1.12.5"},{"location":"episode2/demo/#switch-directories","text":"cd ../istio-1.13.2 Make sure your PATH now points to version 1.13.2 of the istioctl CLI: istioctl version","title":"Switch directories"},{"location":"episode2/demo/#install-istio-version-1132","text":"Pre-check: istioctl x precheck Install: istioctl install --set revision = 1 -13-2 Both 1-13-2 and 1-12-5 istiod's are installed ingressgateway has been upgraded to 1.13.2 Pods still use 1-12-5 Check: k get pods -n istio-system -l app = istiod And: istioctl proxy-status","title":"Install Istio version 1.13.2"},{"location":"episode2/demo/#update-namespace-label","text":"kubectl label namespace default istio.io/rev = 1 -13-2 --overwrite Check: k get ns -Listio.io/rev","title":"Update namespace label"},{"location":"episode2/demo/#restart-the-deployments-in-the-default-namespace","text":"kubectl rollout restart deployment -n default istioctl proxy-status","title":"Restart the deployments in the default namespace"},{"location":"episode2/demo/#teardown-the-old-version","text":"istioctl x uninstall --revision 1 -12-5 Verify that the bookinfo application is still alive and well.","title":"Teardown the old version"},{"location":"episode2/demo/#using-revision-tags","text":"Instead of specifying the actual revision we want, we use a semantic name, like prod : k label ns default istio.io/rev = prod --overwrite And then associate prod to a revision: istioctl tag set prod --revision 1 -13-2 Check: istioctl tag list To change what prod means, we associate a different revision to it: istioctl tag set prod --revision 1 -12-3 --overwrite","title":"Using Revision Tags"},{"location":"episode2/demo/#references","text":"Canary upgrades Revision tags Blog entry","title":"References"},{"location":"episode4/","text":"Episode 4 \u00b6 When \u00b6 Friday 2022.04.22 @ 9:00 AM Pacific time Guest: Lucas Ponce \u00b6 Lucas is a Principal Software Engineer at Red Hat, and is based in Spain. We look forward to having him on the show and learning from him. Bring your questions! Topic: Exploring the Kiali console \u00b6 We will be exploring Kiali, a graphical user interface designed specifically for the Istio service mesh. Your Host: Eitan Suez \u00b6 Eitan will be hosting this episode from Austin, Texas.","title":"Description"},{"location":"episode4/#episode-4","text":"","title":"Episode 4"},{"location":"episode4/#when","text":"Friday 2022.04.22 @ 9:00 AM Pacific time","title":"When"},{"location":"episode4/#guest-lucas-ponce","text":"Lucas is a Principal Software Engineer at Red Hat, and is based in Spain. We look forward to having him on the show and learning from him. Bring your questions!","title":"Guest: Lucas Ponce"},{"location":"episode4/#topic-exploring-the-kiali-console","text":"We will be exploring Kiali, a graphical user interface designed specifically for the Istio service mesh.","title":"Topic:  Exploring the Kiali console"},{"location":"episode4/#your-host-eitan-suez","text":"Eitan will be hosting this episode from Austin, Texas.","title":"Your Host: Eitan Suez"},{"location":"episode5/","text":"Episode 5 \u00b6 When \u00b6 Friday 2022.05.06 @ 9:00 AM Pacific time Guest: Brian Sletten \u00b6 Brian is the president of Bosatsu Consulting . He is a consultant, trainer, and also author of WebAssembly: The Definitive Guide . We look forward to having him on the show and asking him lots of questions about Web Assembly and other subjects. Bring your questions! Topic: Web Assembly \u00b6 Eitan will demo how Web Assembly can be used today in the context of Istio service mesh. Your Host: Eitan Suez \u00b6 Eitan will be hosting this episode from Austin, Texas.","title":"Description"},{"location":"episode5/#episode-5","text":"","title":"Episode 5"},{"location":"episode5/#when","text":"Friday 2022.05.06 @ 9:00 AM Pacific time","title":"When"},{"location":"episode5/#guest-brian-sletten","text":"Brian is the president of Bosatsu Consulting . He is a consultant, trainer, and also author of WebAssembly: The Definitive Guide . We look forward to having him on the show and asking him lots of questions about Web Assembly and other subjects. Bring your questions!","title":"Guest: Brian Sletten"},{"location":"episode5/#topic-web-assembly","text":"Eitan will demo how Web Assembly can be used today in the context of Istio service mesh.","title":"Topic:  Web Assembly"},{"location":"episode5/#your-host-eitan-suez","text":"Eitan will be hosting this episode from Austin, Texas.","title":"Your Host: Eitan Suez"}]}